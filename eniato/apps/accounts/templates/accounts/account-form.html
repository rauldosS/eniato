{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block js %}
    <script src="{% static 'js/forms.js' %}"></script> 
{% endblock js %}

{% block content %}
<div class="px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
    <h1 class="display-4">Nova Conta</h1>
</div>

<form id="form-account" action="." method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}

    {% for hidden_field in form.hidden_fields %}
        {{ hidden_field.errors }}
        {{ hidden_field }}
    {% endfor %}

    <div class="input-group mb-3">
        <span class="input-group-text border-0 p-0 pe-2" for="id_opening_balance">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-piggy-bank" viewBox="0 0 16 16">
                <path d="M5 6.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0zm1.138-1.496A6.613 6.613 0 0 1 7.964 4.5c.666 0 1.303.097 1.893.273a.5.5 0 0 0 .286-.958A7.602 7.602 0 0 0 7.964 3.5c-.734 0-1.441.103-2.102.292a.5.5 0 1 0 .276.962z"/>
                <path fill-rule="evenodd" d="M7.964 1.527c-2.977 0-5.571 1.704-6.32 4.125h-.55A1 1 0 0 0 .11 6.824l.254 1.46a1.5 1.5 0 0 0 1.478 1.243h.263c.3.513.688.978 1.145 1.382l-.729 2.477a.5.5 0 0 0 .48.641h2a.5.5 0 0 0 .471-.332l.482-1.351c.635.173 1.31.267 2.011.267.707 0 1.388-.095 2.028-.272l.543 1.372a.5.5 0 0 0 .465.316h2a.5.5 0 0 0 .478-.645l-.761-2.506C13.81 9.895 14.5 8.559 14.5 7.069c0-.145-.007-.29-.02-.431.261-.11.508-.266.705-.444.315.306.815.306.815-.417 0 .223-.5.223-.461-.026a.95.95 0 0 0 .09-.255.7.7 0 0 0-.202-.645.58.58 0 0 0-.707-.098.735.735 0 0 0-.375.562c-.024.243.082.48.32.654a2.112 2.112 0 0 1-.259.153c-.534-2.664-3.284-4.595-6.442-4.595zM2.516 6.26c.455-2.066 2.667-3.733 5.448-3.733 3.146 0 5.536 2.114 5.536 4.542 0 1.254-.624 2.41-1.67 3.248a.5.5 0 0 0-.165.535l.66 2.175h-.985l-.59-1.487a.5.5 0 0 0-.629-.288c-.661.23-1.39.359-2.157.359a6.558 6.558 0 0 1-2.157-.359.5.5 0 0 0-.635.304l-.525 1.471h-.979l.633-2.15a.5.5 0 0 0-.17-.534 4.649 4.649 0 0 1-1.284-1.541.5.5 0 0 0-.446-.275h-.56a.5.5 0 0 1-.492-.414l-.254-1.46h.933a.5.5 0 0 0 .488-.393zm12.621-.857a.565.565 0 0 1-.098.21.704.704 0 0 1-.044-.025c-.146-.09-.157-.175-.152-.223a.236.236 0 0 1 .117-.173c.049-.027.08-.021.113.012a.202.202 0 0 1 .064.199z"/>
            </svg>
        </span>
        <input
            class="form-control border-0 ms-2 border-bottom currency currency-mask-with-dot"
            type="text"
            name="opening_balance"
            placeholder="0,00"
            id="id_opening_balance"
            value="{{ form.opening_balance.value|default:0 }}"
            {% if form.opening_balance.value %}disabled{% endif %}
            required
        >
    </div>

    <div class="input-group mb-3 d-flex align-items-center">
        <span class="input-group-text border-0 p-0 pe-2" for="id_financial_institution">
            <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
                <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.501.501 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89L8 0ZM3.777 3h8.447L8 1 3.777 3ZM2 6v7h1V6H2Zm2 0v7h2.5V6H4Zm3.5 0v7h1V6h-1Zm2 0v7H12V6H9.5ZM13 6v7h1V6h-1Zm2-1V4H1v1h14Zm-.39 9H1.39l-.25 1h13.72l-.25-1Z"/>
            </svg>
        </span>
        <div class="form-floating">
            <select class="form-select" name="financial_institution" id="id_financial_institution" required="">
                <option value="" selected>Selecione uma instituição financeira</option>
                {% for value, text in form.financial_institution.field.choices %}
                    <option value="{{ value }}" {% if form.financial_institution.value == value %}selected{% endif %}>{{ text }}</option>
                {% endfor %}
            </select>
            <label for="id_financial_institution">Instituição Financeira</label>
        </div>
    </div>
    
    <div class="input-group mb-3">
        <span class="input-group-text border-0 p-0 pe-2" for="id_description">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-card-text" viewBox="0 0 16 16">
                <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"/>
                <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
            </svg>
        </span>
        <input
            class="form-control border-0 ms-2 border-bottom"
            type="text"
            maxlength="255"
            name="description"
            placeholder="Descrição"
            required=""
            id="id_description"
            value="{{ form.description.value }}"
        >
    </div>

    <div class="input-group mb-3 d-flex align-items-center">
        <span class="input-group-text border-0 p-0 pe-2" for="id_account_type">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-wallet2" viewBox="0 0 16 16">
                <path d="M12.136.326A1.5 1.5 0 0 1 14 1.78V3h.5A1.5 1.5 0 0 1 16 4.5v9a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 13.5v-9a1.5 1.5 0 0 1 1.432-1.499L12.136.326zM5.562 3H13V1.78a.5.5 0 0 0-.621-.484L5.562 3zM1.5 4a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-13z"/>
            </svg>
        </span>
        <div class="form-floating">
            <select class="form-select" name="account_type" id="id_account_type" required="">
                <option value="" selected>Selecione tipo de conta</option>
                {% for value, text in form.account_type.field.choices %}
                    <option value="{{ value }}" {% if form.account_type.value == value %}selected{% endif %}>{{ text }}</option>
                {% endfor %}
            </select>
            <label for="id_account_type">Tipo de conta</label>
        </div>
    </div>

    <div class="input-group mb-4">
        <span class="input-group-text border-0 p-0 pe-2" for="id_color">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-palette2" viewBox="0 0 16 16">
                <path d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 .5.5v5.277l4.147-4.131a.5.5 0 0 1 .707 0l3.535 3.536a.5.5 0 0 1 0 .708L10.261 10H15.5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5H3a2.99 2.99 0 0 1-2.121-.879A2.99 2.99 0 0 1 0 13.044m6-.21 7.328-7.3-2.829-2.828L6 7.188v5.647zM4.5 13a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0zM15 15v-4H9.258l-4.015 4H15zM0 .5v12.495V.5z"/>
                <path d="M0 12.995V13a3.07 3.07 0 0 0 0-.005z"/>
            </svg>
        </span>
        <label class="ms-3">Cor da conta</label>
        <input type="hidden" id="id_color" name="color" value="{{ form.color.value }}">
    </div>

    <div class="d-flex justify-content-center mb-4">
        {% for name, value in form.color.field.choices %}
            <div class="color {% if form.color.value == name %}activate{% endif %} {{ name }}" color="{{ name }}"></div>
        {% endfor %}
    </div>

    <div class="form-check form-switch ms-4">
        <input class="form-check-input" type="checkbox" id="id_default" name="default" {% if form.default.value %}checked{% endif %}>
        <label class="form-check-label" for="id_default">Conta Padrão</label>
    </div>

    <div class="form-check form-switch ms-4 mb-3">
        <input class="form-check-input" type="checkbox" id="id_include_on_dashboard" name="include_on_dashboard" {% if form.default.value %}checked{% else %}checked{% endif %}>
        <label class="form-check-label" for="id_include_on_dashboard">Incluir na soma da tela inicial</label>
    </div>

    <div class="d-grid gap-2 col-6 mx-auto mt-3">
        <button class="btn btn-primary" type="submit">Salvar</button>
    </div>
</form>
{% endblock %}

{% block custom_css %}
<style>
    #form-account {
        max-width: 520px;
        width: 520px;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
    }
</style>
{% endblock %}
